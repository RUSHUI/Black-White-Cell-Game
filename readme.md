# Black-White-Gum-Game

### 游戏背景：
一个黑白格小游戏，该游戏教程是[A闪](https://ashan.org/)为了新手学习[egret](https://www.egret.com/)H5游戏框架而录制的。
教程地址：https://ashan.org/archives/646


依赖库：
egret 5.1.7

开发IDE：
webstorm 2017.3

### 游戏玩法：
20秒内尽快的准确的点击最底下一行的黑块，点对一次的一分；点到非指定黑块结束游戏；得分越高越好；

### 游戏实现：

#### 关键类：
从视频中实现的顺序来写：

##### Rect类
实现游戏中最基本的显示对象方块；
 1. 方块可以被点击交互，开启egret默认关闭的属性touchEnable
 2. 方块存在四种颜色，私有变量_colors存储四种颜色 分别为黑白红蓝
 3. 由于画出方块需要指定一种颜色，_currentColor标识该方块使用的颜色索引
 4. 方块需要被绘制出来，使用egret中带有绘图(graphics)对象的Sprite绘制该方块；
    1. 绘制描边为黑色
    2. 绘制(四分之一屏幕宽度)方块填充颜色为蓝色
    3. 设置方块大小为屏幕宽度(需要通过egret的方法获取到屏幕宽度(参见Data类))的四分之一

 5. 不同的方块存在点击后不同的行为状态，用一个type来描述不同的方块(参见RectType类)
 6. 方块的点击处理器
    此处只需根据点击的是不同的方块将方块颜色改变，然后重新绘制方块
 ##### RectType类   
 实现方块的类型：
 1. 定义俩个静态公开类型：CLICKABLE和NONCLICKABLE
 之所以要出现这个类，个人觉得该类是将程序变化封装到一个类中，也是程序玩法扩展的地方，加入增加了其他类型，那么只需要在该类中增加类型，其他类只需要增加方法即可，不会影响其他逻辑
 
 ##### Data类
 实现一些数据计算的方法
  1. 公开的num字段用来描述一行几个方块
  2. 私有的_rectWidth描述方块边长的字段
  3. 公开的getRectWidth方法提供给外部调，用来获取方块边长
  4. 公开的score
  5. 获取屏幕对象
  6. 公开的方法用来获取方格行数
 
 ##### GroupRect类
 该游戏中一行方块作为主要操作逻辑对象，实现一行方块的封装，非常重要。
  1. 私有变量_rects存储一行中的方块
  2. 创建一行中的方块需要存在一个随机位置为黑色可点的方块，通过随机设置其中一个方块的type属性为CLICKABLE即可
  3. 私有方法createRects实例化一行中的多个方块，并添加到行容器(egret.Sprite)中
    并方块实例监听点击交互行为，触发行的onClickRect事件
  4. 私有变量_currentRow存储当前行序号
  5. 点击交互的处理器，处理点击的显示效果，点击之后的逻辑，是move，还是over
  6. 因为方块创建后会被重复利用，所以在设置黑色方块的时候需要对方块的状态初始化一次，公有方法init，用来初始化方块为白色方块（设置type为NONCLICKABLE）
  7. 行移动方法，当前行号+1，当前行号不为尾行，更新y坐标，若为尾行需要上移至顶行，并重新设置黑色格子位置
  
  ##### Game类
  游戏的主要业务类
  1. 实例化GroupRect，使界面铺满方格
  2. 实例化定时TimerPanel
  3. 启动游戏调用私有方法startGame方法
  4. 私有方法nextRow方法实现正确点击后移动方格
  5. 私有方法，gameOver事件处理器中实例gameOverPanel面板
  6. startGame方法，初始化游戏中的方格状态与位置，并重新启用重置的计时器
  
  ##### TimerPanel类
  主要实现游戏倒计时功能
  1. egret.Timer构造器实例化定时器
  2. Timer的实例reset方法重置定时器
  3. Timer的实例方法start方法重启定时器
  4. Timer的实例方法stop停止定时器
  
  #### GameOverPanel类
  主要实现了游戏结束界面
  1. 构造函数中绘制面板
  2. 构造函数中监听被添加到舞台上事件，将动态数据score写入面板中的text
  3. 创建一个开始游戏按钮，监听点击事件
  4. 点击事件处理器，实现移除自身，并抛出startGame事件
  5. 更新结束文案的方法showText
  
  从这个简单游戏中，我第一次这么清晰的看到到面向对象编程和面向过程编程的差异
  每一份数据每一个操作都有自己的归属，而不是函数式编程那样散乱的函数一个个堆叠起来，我也感觉到面向对象编程的优秀的扩展能力。
  
  
  
  
  
  
